<!DOCTYPE html>
<html lang=\"en\">
<head>
    <meta charset=\"UTF-8\">
    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">
    <title>Al Jazeera News Scraper - Islamic AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 30px;
        }
        
        .search-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .search-form {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        
        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .search-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .option-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .option-group label {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .option-group select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .regions-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .region-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            opacity: 0.9;
        }
        
        .results-section {
            margin-top: 30px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .news-article {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .news-article:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .article-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .article-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #666;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .article-summary {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .article-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .read-more {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.2s;
        }
        
        .read-more:hover {
            color: #764ba2;
        }
        
        .relevance-score {
            background: #e3f2fd;
            color: #1976d2;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }
        
        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #c62828;
        }
        
        .success-message {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #2e7d32;
        }
        
        .islamic-context {
            background: #f3e5f5;
            border-left: 4px solid #9c27b0;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .islamic-context h4 {
            color: #7b1fa2;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .search-form {
                flex-direction: column;
            }
            
            .search-input {
                min-width: 100%;
            }
            
            .options {
                flex-direction: column;
            }
            
            .stat-card {
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div class=\"container\">
        <div class=\"header\">
            <h1>üåç Al Jazeera News Scraper</h1>
            <p>Advanced News Integration for Islamic AI - Real-time News from All Regions</p>
        </div>
        
        <div class=\"main-content\">
            <div class=\"search-section\">
                <form class=\"search-form\" id=\"searchForm\">
                    <input 
                        type=\"text\" 
                        class=\"search-input\" 
                        id=\"searchQuery\" 
                        placeholder=\"Search for news (e.g., 'Palestine latest news', 'Islamic events today', 'Middle East updates')...\"
                        required
                    >
                    <button type=\"submit\" class=\"search-btn\">üîç Search News</button>
                    
                    <div class=\"options\">
                        <div class=\"option-group\">
                            <label>Max Articles:</label>
                            <select id=\"maxArticles\">
                                <option value=\"5\">5 Articles</option>
                                <option value=\"10\" selected>10 Articles</option>
                                <option value=\"20\">20 Articles</option>
                                <option value=\"50\">50 Articles</option>
                            </select>
                        </div>
                        
                        <div class=\"option-group\">
                            <label>Sort By:</label>
                            <select id=\"sortBy\">
                                <option value=\"relevance\" selected>Relevance</option>
                                <option value=\"date\">Date</option>
                                <option value=\"importance\">Importance</option>
                            </select>
                        </div>
                        
                        <div class=\"option-group\">
                            <label>Force Refresh:</label>
                            <input type=\"checkbox\" id=\"forceRefresh\">
                        </div>
                    </div>
                    
                    <div class=\"option-group\">
                        <label>Select Regions:</label>
                        <div class=\"regions-selector\">
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-main\" value=\"main\" checked>
                                <label for=\"region-main\">Main</label>
                            </div>
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-middleEast\" value=\"middleEast\" checked>
                                <label for=\"region-middleEast\">Middle East</label>
                            </div>
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-world\" value=\"world\" checked>
                                <label for=\"region-world\">World</label>
                            </div>
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-africa\" value=\"africa\">
                                <label for=\"region-africa\">Africa</label>
                            </div>
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-asia\" value=\"asia\">
                                <label for=\"region-asia\">Asia</label>
                            </div>
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-usCanada\" value=\"usCanada\">
                                <label for=\"region-usCanada\">US & Canada</label>
                            </div>
                            <div class=\"region-checkbox\">
                                <input type=\"checkbox\" id=\"region-europe\" value=\"europe\">
                                <label for=\"region-europe\">Europe</label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class=\"stats-section\" id=\"statsSection\">
                <div class=\"stat-card\">
                    <div class=\"stat-number\" id=\"totalArticles\">0</div>
                    <div class=\"stat-label\">Total Articles</div>
                </div>
                <div class=\"stat-card\">
                    <div class=\"stat-number\" id=\"totalRegions\">9</div>
                    <div class=\"stat-label\">Available Regions</div>
                </div>
                <div class=\"stat-card\">
                    <div class=\"stat-number\" id=\"lastUpdated\">-</div>
                    <div class=\"stat-label\">Last Updated</div>
                </div>
                <div class=\"stat-card\">
                    <div class=\"stat-number\" id=\"searchTime\">-</div>
                    <div class=\"stat-label\">Search Time (ms)</div>
                </div>
            </div>
            
            <div class=\"results-section\" id=\"resultsSection\">
                <div class=\"islamic-context\">
                    <h4>üïå Islamic AI News Integration</h4>
                    <p>This advanced news scraper fetches real-time information from Al Jazeera's regional websites and integrates it with Islamic guidance. The system uses sophisticated algorithms to categorize news, assess relevance, and provide context that aligns with Islamic values and teachings.</p>
                    <p><strong>Features:</strong> DSA-level data structures, intelligent caching, sentiment analysis, importance scoring, and Islamic context integration.</p>
                </div>
            </div>
        </div>
    </div>
    
    <script type=\"module\">
        // Import our news scraping modules
        import { AlJazeeraNewsScraper } from './src/aljazeera-news-scraper.js';
        import { NewsIntegrationService } from './src/news-integration-service.js';
        
        class NewsScraperUI {
            constructor() {
                this.newsService = new NewsIntegrationService();
                this.currentResults = null;
                this.isSearching = false;
                
                this.initializeEventListeners();
                this.updateStats();
            }
            
            initializeEventListeners() {
                const searchForm = document.getElementById('searchForm');
                searchForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.performSearch();
                });
            }
            
            async performSearch() {
                if (this.isSearching) return;
                
                const query = document.getElementById('searchQuery').value.trim();
                if (!query) {
                    this.showError('Please enter a search query');
                    return;
                }
                
                this.isSearching = true;
                const startTime = Date.now();
                
                try {
                    this.showLoading();
                    
                    // Get selected regions
                    const regions = this.getSelectedRegions();
                    const maxArticles = parseInt(document.getElementById('maxArticles').value);
                    const forceRefresh = document.getElementById('forceRefresh').checked;
                    
                    console.log('Starting news search...', { query, regions, maxArticles, forceRefresh });
                    
                    // Get relevant news
                    const newsData = await this.newsService.getRelevantNews(query, {
                        maxArticles,
                        regions,
                        forceRefresh
                    });
                    
                    const searchTime = Date.now() - startTime;
                    
                    console.log('News search completed:', newsData);
                    
                    this.currentResults = newsData;
                    this.displayResults(newsData);
                    this.updateSearchStats(searchTime, newsData);
                    
                    if (newsData.hasNews) {
                        this.showSuccess(`Found ${newsData.articlesFound} relevant articles in ${searchTime}ms`);
                    } else {
                        this.showInfo('No relevant news articles found for your query. Try different keywords or check back later.');
                    }
                    
                } catch (error) {
                    console.error('Search error:', error);
                    this.showError(`Search failed: ${error.message}`);
                } finally {
                    this.isSearching = false;
                }
            }
            
            getSelectedRegions() {
                const regions = [];
                const checkboxes = document.querySelectorAll('.region-checkbox input[type=\"checkbox\"]:checked');
                checkboxes.forEach(checkbox => {
                    regions.push(checkbox.value);
                });
                return regions.length > 0 ? regions : ['main', 'middleEast', 'world'];
            }
            
            showLoading() {
                const resultsSection = document.getElementById('resultsSection');
                resultsSection.innerHTML = `
                    <div class=\"loading\">
                        <div class=\"spinner\"></div>
                        <p>Scraping Al Jazeera news from multiple regions...</p>
                        <p>Please wait while we fetch the latest articles...</p>
                    </div>
                `;
            }
            
            displayResults(newsData) {
                const resultsSection = document.getElementById('resultsSection');
                
                if (!newsData.hasNews || !newsData.newsData || newsData.newsData.results.length === 0) {
                    resultsSection.innerHTML = `
                        <div class=\"islamic-context\">
                            <h4>üîç Search Results</h4>
                            <p>No relevant news articles found for your query. This could be because:</p>
                            <ul>
                                <li>The topic is not currently covered in Al Jazeera's recent articles</li>
                                <li>Try using different keywords or broader terms</li>
                                <li>Check the selected regions - you might want to include more regions</li>
                            </ul>
                            <p><strong>Suggestion:</strong> Try searching for broader topics like \"Middle East\", \"Islamic world\", or \"Muslim community\".</p>
                        </div>
                    `;
                    return;
                }
                
                let html = `
                    <div class=\"islamic-context\">
                        <h4>üîç Search Results for \"${newsData.newsData.query}\"</h4>
                        <p>Found <strong>${newsData.articlesFound}</strong> relevant articles from Al Jazeera's regional websites.</p>
                        <p><strong>Integration:</strong> These articles have been processed and can be integrated with Islamic guidance and teachings.</p>
                    </div>
                `;
                
                newsData.newsData.results.forEach((article, index) => {
                    const publishedDate = new Date(article.publishedAt).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    const timeAgo = this.getTimeAgo(new Date(article.publishedAt));
                    
                    html += `
                        <div class=\"news-article\">
                            <div class=\"article-title\">${article.title}</div>
                            <div class=\"article-meta\">
                                <div class=\"meta-item\">
                                    <span>üåç</span>
                                    <span>${article.region}</span>
                                </div>
                                <div class=\"meta-item\">
                                    <span>üìÇ</span>
                                    <span>${article.category}</span>
                                </div>
                                <div class=\"meta-item\">
                                    <span>üìÖ</span>
                                    <span>${publishedDate} (${timeAgo})</span>
                                </div>
                                ${article.author && article.author !== 'Al Jazeera' ? `
                                <div class=\"meta-item\">
                                    <span>‚úçÔ∏è</span>
                                    <span>${article.author}</span>
                                </div>
                                ` : ''}
                            </div>
                            ${article.summary ? `
                            <div class=\"article-summary\">${article.summary}</div>
                            ` : ''}
                            <div class=\"article-actions\">
                                <a href=\"${article.url}\" target=\"_blank\" class=\"read-more\">Read Full Article ‚Üí</a>
                                <div class=\"relevance-score\">Relevance: ${article.relevanceScore || 0}</div>
                            </div>
                        </div>
                    `;
                });
                
                // Add AI integration example
                html += `
                    <div class=\"islamic-context\">
                        <h4>ü§ñ AI Integration Preview</h4>
                        <p><strong>Enhanced Prompt Generated:</strong></p>
                        <div style=\"background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 0.9em; max-height: 200px; overflow-y: auto;\">
                            ${newsData.enhancedPrompt.replace(/\n/g, '<br>').substring(0, 1000)}...
                        </div>
                        <p style=\"margin-top: 10px;\"><strong>This enhanced prompt</strong> would be used by the Islamic AI to provide contextually relevant responses that combine current news with Islamic guidance.</p>
                    </div>
                `;
                
                resultsSection.innerHTML = html;
            }
            
            getTimeAgo(date) {
                const now = new Date();
                const diffMs = now - date;
                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
                const diffDays = Math.floor(diffHours / 24);
                
                if (diffHours < 1) return 'Less than 1 hour ago';
                if (diffHours < 24) return `${diffHours} hours ago`;
                if (diffDays === 1) return '1 day ago';
                return `${diffDays} days ago`;
            }
            
            async updateStats() {
                try {
                    const stats = await this.newsService.getNewsStatistics();
                    if (stats) {
                        document.getElementById('totalArticles').textContent = stats.totalArticles || 0;
                        document.getElementById('lastUpdated').textContent = stats.lastUpdated ? 
                            new Date(stats.lastUpdated).toLocaleDateString() : '-';
                    }
                } catch (error) {
                    console.error('Error updating stats:', error);
                }
            }
            
            updateSearchStats(searchTime, newsData) {
                document.getElementById('searchTime').textContent = searchTime;
                if (newsData.hasNews && newsData.newsData) {
                    document.getElementById('totalArticles').textContent = newsData.newsData.totalFound || 0;
                }
            }
            
            showError(message) {
                const resultsSection = document.getElementById('resultsSection');
                resultsSection.innerHTML = `
                    <div class=\"error-message\">
                        <strong>Error:</strong> ${message}
                    </div>
                    ${resultsSection.innerHTML}
                `;
            }
            
            showSuccess(message) {
                const resultsSection = document.getElementById('resultsSection');
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                successDiv.innerHTML = `<strong>Success:</strong> ${message}`;
                resultsSection.insertBefore(successDiv, resultsSection.firstChild);
                
                // Remove success message after 5 seconds
                setTimeout(() => {
                    if (successDiv.parentNode) {
                        successDiv.remove();
                    }
                }, 5000);
            }
            
            showInfo(message) {
                const resultsSection = document.getElementById('resultsSection');
                resultsSection.innerHTML = `
                    <div class=\"islamic-context\">
                        <h4>‚ÑπÔ∏è Information</h4>
                        <p>${message}</p>
                    </div>
                    ${resultsSection.innerHTML}
                `;
            }
        }
        
        // Initialize the UI when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Initializing Al Jazeera News Scraper UI...');
            const ui = new NewsScraperUI();
            
            // Add some example queries
            const examples = [
                'Palestine latest news',
                'Islamic events today',
                'Middle East updates',
                'Muslim community news',
                'Ramadan celebrations',
                'Islamic finance news'
            ];
            
            console.log('Example queries you can try:', examples);
        });
    </script>
</body>
</html>